<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Menú - Café Rápida</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap y Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://kit.fontawesome.com/a2d60a85e5.js" crossorigin="anonymous"></script>
    <style>
        .card {
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .category-title {
            margin-top: 40px;
        }
        .saludo {
            font-size: 1.5rem;
            margin-bottom: 20px;
        }
        .filtro-container {
            margin-bottom: 20px;
        }
    </style>
</head>
<body class="bg-light">

<div class="container py-4">
    <!-- Saludo motivador -->
    <div class="text-center saludo">
        <strong>¡Buen provecho, {{ usuario }}!</strong> ¿Qué te gustaría pedir hoy?
    </div>

    <!-- Filtro y búsqueda -->
    <div class="row filtro-container">
        <div class="col-md-6">
            <input type="text" class="form-control" id="busqueda" placeholder="Buscar producto...">
        </div>
        <div class="col-md-6">
            <select class="form-select" id="filtroCategoria">
                <option value="todos">Todas las categorías</option>
                <option value="Bebida Caliente">Bebidas Calientes</option>
                <option value="Bebida Fría">Bebidas Frías</option>
                <option value="Comida">Comida</option>
                <option value="Snack">Snacks</option>
            </select>
        </div>
    </div>

    <!-- Menú de productos -->
    <div class="row" id="lista-productos">  
        {% for producto in productos %}
        <div class="col-md-4 mb-4 producto" data-categoria="{{ producto.categoria | lower }}">
            <div class="card h-100">
                <div class="card-body text-center">
                    <!-- Icono según categoría -->
                    <img src="{{ url_for('static', filename=producto.imagen) }}" alt="{{ producto.nombre }}" class="img-fluid mb-3" style="max-height: 150px;">

                    <h5 class="card-title">{{ producto.nombre }}</h5>
                    <p class="card-text">{{ producto.descripcion }}</p>
                    <p><strong>${{ producto.precio }}</strong></p>
                    
                    <!-- Botón agregar al carrito -->
                    <a href="{{ url_for('agregar_al_carrito', producto_id=producto.id) }}" class="btn btn-success w-100">
                        <i class="fa-solid fa-cart-plus"></i> Agregar al carrito
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Ver carrito -->
    <div class="text-center mt-4">
        <a href="{{ url_for('carrito') }}" class="btn btn-primary">
            <i class="fa-solid fa-shopping-cart"></i> Ver carrito
        </a>
    </div>

    <!-- Cerrar sesión -->
    <div class="text-center mt-4">
        <a href="{{ url_for('logout') }}" class="btn btn-outline-secondary">
            <i class="fa-solid fa-right-from-bracket"></i> Cerrar sesión
        </a>
    </div>
</div>

<!-- Scripts para búsqueda y filtro -->
<script>
    const inputBusqueda = document.getElementById('busqueda');
    const filtroCategoria = document.getElementById('filtroCategoria');
    const productos = document.querySelectorAll('.producto');

    function filtrarProductos() {
        const texto = inputBusqueda.value.toLowerCase();
        const categoria = filtroCategoria.value.toLowerCase();

        productos.forEach(producto => {
            const nombre = producto.querySelector('.card-title').innerText.toLowerCase();
            const coincideTexto = nombre.includes(texto);
            const coincideCategoria = (categoria === 'todos' || producto.dataset.categoria === categoria);
            producto.style.display = (coincideTexto && coincideCategoria) ? 'block' : 'none';
        });
    }

    inputBusqueda.addEventListener('input', filtrarProductos);
    filtroCategoria.addEventListener('change', filtrarProductos);
</script>

</body>
</html>
